<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SICP exercises</title>
<meta name="generator" content="Org mode" />
<meta name="author" content=" Norris" />
<link rel="stylesheet" type="text/css" href="https://gongzhitaao.org/orgcss/org.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">SICP exercises</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org93613c7">1. Exercise 1.1</a></li>
<li><a href="#orgd213ca0">2. Exercise 1.2</a></li>
<li><a href="#org53c8ec8">3. Exercise 1.3</a></li>
<li><a href="#org9b2ca4e">4. Exercise 1.4</a></li>
<li><a href="#org5588fad">5. Exercise 1.5</a></li>
<li><a href="#org40fd791">6. Exercise 1.6</a></li>
<li><a href="#orgdf93a28">7. Exercise 1.7</a></li>
<li><a href="#orgaad7a3f">8. Exercise 1.8</a></li>
<li><a href="#orgfd11e27">9. Exercise 1.9</a></li>
<li><a href="#orgdf38a35">10. Exercise 1.10</a></li>
<li><a href="#orgd9c5bd1">11. Exercise 1.11</a></li>
<li><a href="#orgf52b294">12. Exercise 1.12</a></li>
<li><a href="#org085f9b6">13. Exercise 1.16</a></li>
<li><a href="#org81763c8">14. Exercise 1.17</a></li>
<li><a href="#orgf271538">15. Exercise 1.21</a></li>
<li><a href="#org5d9f8b7">16. Exercise 1.22</a></li>
<li><a href="#org0f6bd0c">17. Exercise 1.26</a></li>
<li><a href="#org94262b2">18. Exercise 1.29</a></li>
<li><a href="#orgebfd88c">19. Exercise 1.30</a></li>
<li><a href="#org80758c4">20. Exercise 1.31</a>
<ul>
<li><a href="#org2fc7af8">20.1. a</a></li>
<li><a href="#org52643cd">20.2. b</a></li>
</ul>
</li>
<li><a href="#orgd931b27">21. Exercise 1.32</a></li>
<li><a href="#orgf8670de">22. Exercise 1.34</a></li>
<li><a href="#org08b57dd">23. Exercise 1.35</a></li>
<li><a href="#orgef64ca4">24. Exercise 1.36</a></li>
<li><a href="#org0c22bec">25. Exercise 1.37</a></li>
<li><a href="#orga6d3812">26. Exercise 1.40</a></li>
<li><a href="#orgf8a7cd9">27. Exercise 1.42</a></li>
<li><a href="#org53a70ee">28. Exercise 1.43</a></li>
<li><a href="#orgc6566d7">29. Exercise 2.1</a></li>
<li><a href="#orgb457321">30. Exercise 2.2</a></li>
<li><a href="#org5f9dde4">31. Exercise 2.20</a></li>
<li><a href="#org7d07bb2">32. Exercise 2.23</a></li>
<li><a href="#org17abb9e">33. Exercise 2.30</a></li>
<li><a href="#orgdb1a705">34. Exercise 2.31</a></li>
<li><a href="#org50a89ff">35. Exercise 2.33</a></li>
</ul>
</div>
</div>

<div id="outline-container-org93613c7" class="outline-2">
<h2 id="org93613c7"><span class="section-number-2">1</span> Exercise 1.1</h2>
<div class="outline-text-2" id="text-1">
<p>
10
12
8
3
4
a
b
19
#f
4
16
6
6
16
</p>
</div>
</div>

<div id="outline-container-orgd213ca0" class="outline-2">
<h2 id="orgd213ca0"><span class="section-number-2">2</span> Exercise 1.2</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>/ <span style="color: #BFEBBF;">(</span>+ 
    <span style="color: #BFEBBF;">5</span> <span style="color: #BFEBBF;">4</span> 
    <span style="color: #D0BF8F;">(</span>- <span style="color: #BFEBBF;">2</span> 
       <span style="color: #93E0E3;">(</span>- <span style="color: #BFEBBF;">3</span> 
          <span style="color: #9FC59F;">(</span>+ <span style="color: #BFEBBF;">6</span> 
             <span style="color: #94BFF3;">(</span>/ <span style="color: #BFEBBF;">4</span> <span style="color: #BFEBBF;">5</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span> 
   <span style="color: #BFEBBF;">(</span>* <span style="color: #BFEBBF;">3</span> 
      <span style="color: #D0BF8F;">(</span>- <span style="color: #BFEBBF;">6</span> <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span> 
      <span style="color: #D0BF8F;">(</span>- <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">7</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org53c8ec8" class="outline-2">
<h2 id="org53c8ec8"><span class="section-number-2">3</span> Exercise 1.3</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum_of_square</span> x y<span style="color: #BFEBBF;">)</span> 
  <span style="color: #BFEBBF;">(</span>+ <span style="color: #D0BF8F;">(</span>* x x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>* y y<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">procedure</span> a b c<span style="color: #BFEBBF;">)</span> 
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #9FC59F;">(</span>&lt; c a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>&lt; c b<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>sum_of_square a b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #9FC59F;">(</span>&lt; b a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>&lt; b c<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>sum_of_square a c<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #9FC59F;">(</span>&lt; a b<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>&lt; a c<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>sum_of_square b c<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9b2ca4e" class="outline-2">
<h2 id="org9b2ca4e"><span class="section-number-2">4</span> Exercise 1.4</h2>
<div class="outline-text-2" id="text-4">
<p>
if b &gt; 0，return a + b, else return a - b, overall return a + abs(b)
</p>
</div>
</div>

<div id="outline-container-org5588fad" class="outline-2">
<h2 id="org5588fad"><span class="section-number-2">5</span> Exercise 1.5</h2>
<div class="outline-text-2" id="text-5">
<p>
normal order:
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>test x y<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #BFEBBF;">(</span>= x <span style="color: #BFEBBF;">0</span><span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">0</span> y<span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #BFEBBF;">(</span>= <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">0</span><span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">(</span>p<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #BFEBBF;">0</span>
</pre>
</div>

<p>
applicative order:
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>test <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">(</span>p<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>test <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">(</span>p<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
...
</pre>
</div>
</div>
</div>

<div id="outline-container-org40fd791" class="outline-2">
<h2 id="org40fd791"><span class="section-number-2">6</span> Exercise 1.6</h2>
<div class="outline-text-2" id="text-6">
<p>
use if:
</p>

<p>
special form will not use applicative order to analize a procedure, thus clause in old if will not run unless predicate meets. 
</p>

<p>
use new-if:
</p>

<p>
use applicative order, sqrt-iter clause will be expanded, leading maximum recursion depth exceeded.
</p>
</div>
</div>

<div id="outline-container-orgdf93a28" class="outline-2">
<h2 id="orgdf93a28"><span class="section-number-2">7</span> Exercise 1.7</h2>
<div class="outline-text-2" id="text-7">
<p>
because (good-enough?) is checked by absolute difference, small number might meet that in the very beginning.
</p>

<p>
for large numbers, is might cause (improve guess x) equals (guess), thus trapping in infinite loop.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">abs</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&lt; x <span style="color: #BFEBBF;">0</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>* <span style="color: #BFEBBF;">-1</span> x<span style="color: #D0BF8F;">)</span>
      x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* x x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sqrt-iter</span> guess old-guess x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>good-enough? guess old-guess x<span style="color: #D0BF8F;">)</span>
      guess
      <span style="color: #D0BF8F;">(</span>sqrt-iter <span style="color: #93E0E3;">(</span>improve guess x<span style="color: #93E0E3;">)</span> guess x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">improve</span> guess x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>average guess <span style="color: #D0BF8F;">(</span>/ x guess<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">average</span> x y<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>+ x y<span style="color: #D0BF8F;">)</span> <span style="color: #BFEBBF;">2</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">good-enough?</span> guess old-guess x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>&lt; <span style="color: #D0BF8F;">(</span>abs <span style="color: #93E0E3;">(</span>- guess old-guess<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>* guess <span style="color: #BFEBBF;">0.001</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sqrt</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>sqrt-iter <span style="color: #BFEBBF;">1.0</span> <span style="color: #BFEBBF;">2.0</span> x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">new-if</span> predicate then-clause else-clause<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>predicate<span style="color: #D0BF8F;">)</span>
      then-clause
      else-clause<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaad7a3f" class="outline-2">
<h2 id="orgaad7a3f"><span class="section-number-2">8</span> Exercise 1.8</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cube-root</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cube-root-iter <span style="color: #BFEBBF;">1.0</span> <span style="color: #BFEBBF;">2.0</span> x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cube-root-iter</span> guess old-guess x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>good-enough? guess old-guess x<span style="color: #D0BF8F;">)</span>
      guess
      <span style="color: #D0BF8F;">(</span>cube-root-iter <span style="color: #93E0E3;">(</span>improve guess x<span style="color: #93E0E3;">)</span> guess x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">improve</span> guess x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>/ <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>/ x
           <span style="color: #9FC59F;">(</span>* guess guess<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>* <span style="color: #BFEBBF;">2</span> guess<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
     <span style="color: #BFEBBF;">3</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">good-enough?</span> guess old-guess x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>&lt; <span style="color: #D0BF8F;">(</span>abs <span style="color: #93E0E3;">(</span>- guess
             old-guess<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
     <span style="color: #D0BF8F;">(</span>* guess <span style="color: #BFEBBF;">0.001</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">abs</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&lt; x <span style="color: #BFEBBF;">0</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>* <span style="color: #BFEBBF;">-1</span> x<span style="color: #D0BF8F;">)</span>
      x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>cube-root <span style="color: #BFEBBF;">27</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgfd11e27" class="outline-2">
<h2 id="orgfd11e27"><span class="section-number-2">9</span> Exercise 1.9</h2>
<div class="outline-text-2" id="text-9">
<p>
first is recursive, second is iterative.
</p>
</div>
</div>

<div id="outline-container-orgdf38a35" class="outline-2">
<h2 id="orgdf38a35"><span class="section-number-2">10</span> Exercise 1.10</h2>
<div class="outline-text-2" id="text-10">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">10</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">(</span>- <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span><span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #D0BF8F;">(</span>- <span style="color: #BFEBBF;">10</span> <span style="color: #BFEBBF;">1</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #D0BF8F;">(</span>- <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">8</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">8</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #93E0E3;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">7</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #93E0E3;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #9FC59F;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">6</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
...
<span style="color: #BFEBBF;">1024</span>

<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">4</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #93E0E3;">(</span>A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #93E0E3;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">4</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">3</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #93E0E3;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #93E0E3;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #9FC59F;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #93E0E3;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">2</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">4</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">16</span><span style="color: #DCDCCC;">)</span>

<span style="color: #BFEBBF;">65536</span>

<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">3</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">(</span>A <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">2</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
...
<span style="color: #DCDCCC;">(</span>A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">4</span><span style="color: #DCDCCC;">)</span>
<span style="color: #BFEBBF;">65536</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd9c5bd1" class="outline-2">
<h2 id="orgd9c5bd1"><span class="section-number-2">11</span> Exercise 1.11</h2>
<div class="outline-text-2" id="text-11">
<p>
recursive process
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">f</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&lt; n <span style="color: #BFEBBF;">3</span><span style="color: #D0BF8F;">)</span>
      n
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>f <span style="color: #9FC59F;">(</span>- n <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>* <span style="color: #BFEBBF;">2</span> <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>- n <span style="color: #BFEBBF;">2</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>* <span style="color: #BFEBBF;">3</span> <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>- n <span style="color: #BFEBBF;">3</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>

<p>
iterative process
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">f</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>f-iter <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">0</span> n<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">f-iter</span> a b c count<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&lt; count <span style="color: #BFEBBF;">3</span><span style="color: #D0BF8F;">)</span>
      a
      <span style="color: #D0BF8F;">(</span>f-iter <span style="color: #93E0E3;">(</span>+ a
                 <span style="color: #9FC59F;">(</span>* <span style="color: #BFEBBF;">2</span> b<span style="color: #9FC59F;">)</span>
                 <span style="color: #9FC59F;">(</span>* <span style="color: #BFEBBF;">3</span> c<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
              a
              b
              <span style="color: #93E0E3;">(</span>- count <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf52b294" class="outline-2">
<h2 id="orgf52b294"><span class="section-number-2">12</span> Exercise 1.12</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">f</span> r c<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">and</span> <span style="color: #93E0E3;">(</span>&gt; r <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span>
           <span style="color: #93E0E3;">(</span>not <span style="color: #9FC59F;">(</span>eq? r c<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
           <span style="color: #93E0E3;">(</span>not <span style="color: #9FC59F;">(</span>eq? c <span style="color: #BFEBBF;">0</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>f <span style="color: #9FC59F;">(</span>- r <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>- c <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>f <span style="color: #9FC59F;">(</span>- r <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span> c<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #BFEBBF;">1</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org085f9b6" class="outline-2">
<h2 id="org085f9b6"><span class="section-number-2">13</span> Exercise 1.16</h2>
<div class="outline-text-2" id="text-13">
<p>
iterative process, even is faster than odd.
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">even?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>remainder n <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span> <span style="color: #BFEBBF;">0</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* x x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fast-expt</span> b n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>even? n<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>fast-expt-iter <span style="color: #BFEBBF;">1</span>
                      <span style="color: #93E0E3;">(</span>/ n <span style="color: #BFEBBF;">2</span><span style="color: #93E0E3;">)</span>
                      <span style="color: #93E0E3;">(</span>square b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>fast-expt-iter <span style="color: #BFEBBF;">1</span> n b<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fast-expt-iter</span> product count b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= count <span style="color: #BFEBBF;">0</span><span style="color: #D0BF8F;">)</span>
      product
      <span style="color: #D0BF8F;">(</span>fast-expt-iter <span style="color: #93E0E3;">(</span>* b product<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>- count <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span> b<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>fast-expt <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org81763c8" class="outline-2">
<h2 id="org81763c8"><span class="section-number-2">14</span> Exercise 1.17</h2>
<div class="outline-text-2" id="text-14">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">double</span> a<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>+ a a<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fast-*</span> a n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>even? n<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>fast-*-iter <span style="color: #BFEBBF;">0</span> <span style="color: #93E0E3;">(</span>/ n <span style="color: #BFEBBF;">2</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>double a<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>fast-*-iter <span style="color: #BFEBBF;">0</span> n a<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fast-*-iter</span> product count a<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= count <span style="color: #BFEBBF;">0</span><span style="color: #D0BF8F;">)</span>
      product
      <span style="color: #D0BF8F;">(</span>fast-*-iter <span style="color: #93E0E3;">(</span>+ product a<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>- count <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span> a<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>fast-* <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">3</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf271538" class="outline-2">
<h2 id="orgf271538"><span class="section-number-2">15</span> Exercise 1.21</h2>
<div class="outline-text-2" id="text-15">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">smallest-divisor</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>find-divisor-iter n <span style="color: #BFEBBF;">2</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">find-divisor-iter</span> n test-divisor<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>&gt; <span style="color: #9FC59F;">(</span>square test-divisor<span style="color: #9FC59F;">)</span> n<span style="color: #93E0E3;">)</span> n<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>divides? n test-divisor<span style="color: #93E0E3;">)</span> test-divisor<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>find-divisor-iter n <span style="color: #9FC59F;">(</span>+ test-divisor <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">divides?</span> n divisor<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>remainder n divisor<span style="color: #D0BF8F;">)</span> <span style="color: #BFEBBF;">0</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>smallest-divisor <span style="color: #BFEBBF;">199</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>smallest-divisor <span style="color: #BFEBBF;">1999</span><span style="color: #DCDCCC;">)</span>
<span style="color: #DCDCCC;">(</span>smallest-divisor <span style="color: #BFEBBF;">19999</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>

<p>
199 1999 7
</p>
</div>
</div>

<div id="outline-container-org5d9f8b7" class="outline-2">
<h2 id="org5d9f8b7"><span class="section-number-2">16</span> Exercise 1.22</h2>
<div class="outline-text-2" id="text-16">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">expmod</span> base exp mod<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>remainder <span style="color: #D0BF8F;">(</span>expt base exp<span style="color: #D0BF8F;">)</span>
             mod<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">expt</span> base exp<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= exp <span style="color: #BFEBBF;">0</span><span style="color: #93E0E3;">)</span> <span style="color: #BFEBBF;">1</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>* base
                 <span style="color: #9FC59F;">(</span>expt base <span style="color: #94BFF3;">(</span>- exp <span style="color: #BFEBBF;">1</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">try-it</span> a n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>expmod a n n<span style="color: #D0BF8F;">)</span> a<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fermat-test</span> a n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>= a <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span> true<span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>try-it a n<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>fermat-test <span style="color: #9FC59F;">(</span>- a <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span> n<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> false<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">prime?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>fermat-test <span style="color: #D0BF8F;">(</span>- n <span style="color: #BFEBBF;">1</span><span style="color: #D0BF8F;">)</span> n<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">timed-prime-test</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>newline<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>start-prime-test n <span style="color: #D0BF8F;">(</span>runtime<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">start-prime-test</span> n start-time<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>prime? n<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>report-prime <span style="color: #93E0E3;">(</span>- <span style="color: #9FC59F;">(</span>runtime<span style="color: #9FC59F;">)</span> start-time<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">report-prime</span> elapsed-time<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">" *** "</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display elapsed-time<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">even?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #D0BF8F;">(</span>remainder n <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span> <span style="color: #BFEBBF;">0</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">search-for-primes</span> min max<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>timed-prime-test min<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>&lt; min max<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>search-for-primes <span style="color: #9FC59F;">(</span>+ <span style="color: #BFEBBF;">1</span> min<span style="color: #9FC59F;">)</span> max<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> true<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>


<span style="color: #DCDCCC;">(</span>search-for-primes <span style="color: #BFEBBF;">1000</span> <span style="color: #BFEBBF;">1100</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org0f6bd0c" class="outline-2">
<h2 id="org0f6bd0c"><span class="section-number-2">17</span> Exercise 1.26</h2>
<div class="outline-text-2" id="text-17">
<p>
Reasoner's soluton has to run expmod twice, from linear recursion to tree recursion.
</p>

<p>
Time grows exponentially with the depth of tree height, log(n), thus the execution turns to n.
</p>
</div>
</div>

<div id="outline-container-org94262b2" class="outline-2">
<h2 id="org94262b2"><span class="section-number-2">18</span> Exercise 1.29</h2>
<div class="outline-text-2" id="text-18">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum</span> term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&gt; a b<span style="color: #D0BF8F;">)</span>
      <span style="color: #BFEBBF;">0</span>
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>term a<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>sum term <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> next b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">incr</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>+ n <span style="color: #BFEBBF;">1</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum-cubes</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>sum cude a incr b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">even?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>remainder n <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cube</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* n n n<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">simpson-rule</span> f a b x n k<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">h</span>
    <span style="color: #D0BF8F;">(</span>/ <span style="color: #93E0E3;">(</span>- b a<span style="color: #93E0E3;">)</span> n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">coin</span> k<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #94BFF3;">(</span>= n k<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>= <span style="color: #BFEBBF;">0</span> k<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span> <span style="color: #BFEBBF;">1</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>even? k<span style="color: #9FC59F;">)</span> <span style="color: #BFEBBF;">2</span><span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #BFEBBF;">4</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">next</span> m<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>+ m h<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&gt; x b<span style="color: #D0BF8F;">)</span>
      <span style="color: #BFEBBF;">0</span>
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>* <span style="color: #9FC59F;">(</span>coin k<span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span>/ h <span style="color: #BFEBBF;">3</span><span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span>f x<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>simpson-rule f a b <span style="color: #9FC59F;">(</span>next x<span style="color: #9FC59F;">)</span> n <span style="color: #9FC59F;">(</span>+ k <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>


<span style="color: #DCDCCC;">(</span>simpson-rule cube <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">1000</span> <span style="color: #BFEBBF;">0</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>

<p>
官方方法，外面包了一层，这样可以设置一些全局函数
</p>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cube</span> x<span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>* x x x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum</span> term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&gt; a b<span style="color: #D0BF8F;">)</span>
      <span style="color: #BFEBBF;">0</span>
      <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>term a<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span>sum term <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> next b<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">even?</span> n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>remainder n <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">simpson-integral</span> f a b n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">h</span> <span style="color: #D0BF8F;">(</span>/ <span style="color: #93E0E3;">(</span>- b a<span style="color: #93E0E3;">)</span> n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">inc</span> m<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>+ m <span style="color: #BFEBBF;">1</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">yk</span> k<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span>+ a <span style="color: #9FC59F;">(</span>* k h<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">simpson-term</span> k<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>* <span style="color: #93E0E3;">(</span>yk k<span style="color: #93E0E3;">)</span>
       <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span><span style="color: #F0DFAF; font-weight: bold;">or</span> <span style="color: #E0CF9F;">(</span>= k n<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>= <span style="color: #BFEBBF;">0</span> k<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span> <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>even? k<span style="color: #94BFF3;">)</span> <span style="color: #BFEBBF;">2</span><span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #BFEBBF;">4</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* <span style="color: #D0BF8F;">(</span>/ h <span style="color: #BFEBBF;">3</span><span style="color: #D0BF8F;">)</span>
     <span style="color: #D0BF8F;">(</span>sum simpson-term <span style="color: #BFEBBF;">0</span> inc n<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>simpson-integral cube <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">100</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgebfd88c" class="outline-2">
<h2 id="orgebfd88c"><span class="section-number-2">19</span> Exercise 1.30</h2>
<div class="outline-text-2" id="text-19">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">sum</span> term a next b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> a result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>&gt; a b<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>+ result <span style="color: #94BFF3;">(</span>term a<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter a <span style="color: #BFEBBF;">0</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org80758c4" class="outline-2">
<h2 id="org80758c4"><span class="section-number-2">20</span> Exercise 1.31</h2>
<div class="outline-text-2" id="text-20">
</div>
<div id="outline-container-org2fc7af8" class="outline-3">
<h3 id="org2fc7af8"><span class="section-number-3">20.1</span> a</h3>
<div class="outline-text-3" id="text-20-1">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">product</span> term a next b conn<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&gt; a b<span style="color: #D0BF8F;">)</span>
      <span style="color: #BFEBBF;">1.0</span>
      <span style="color: #D0BF8F;">(</span>conn <span style="color: #93E0E3;">(</span>term a<span style="color: #93E0E3;">)</span>
            <span style="color: #93E0E3;">(</span>product term <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> next b conn<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">multiply</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* a b<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">test-formula</span> a b<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">incr</span> n<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>+ n <span style="color: #BFEBBF;">1</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">term</span> k<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">num</span>
      <span style="color: #93E0E3;">(</span>* <span style="color: #9FC59F;">(</span>floor <span style="color: #94BFF3;">(</span>/ <span style="color: #E0CF9F;">(</span>+ k <span style="color: #BFEBBF;">2</span><span style="color: #E0CF9F;">)</span> <span style="color: #BFEBBF;">2</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
         <span style="color: #BFEBBF;">2</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">den</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #9FC59F;">(</span><span style="color: #94BFF3;">(</span>even? k<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>- num <span style="color: #BFEBBF;">1</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #94BFF3;">(</span>+ num <span style="color: #BFEBBF;">1</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>/ num den<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span>product term a incr b multiply<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>* <span style="color: #BFEBBF;">4</span> <span style="color: #BFEBBF;">(</span>test-formula <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">100</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org52643cd" class="outline-3">
<h3 id="org52643cd"><span class="section-number-3">20.2</span> b</h3>
<div class="outline-text-3" id="text-20-2">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">product</span> term a next b conn<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">iter</span> a result<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>&gt; a b<span style="color: #93E0E3;">)</span>
        result
        <span style="color: #93E0E3;">(</span>iter <span style="color: #9FC59F;">(</span>next a<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>conn result <span style="color: #94BFF3;">(</span>term a<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>iter a <span style="color: #BFEBBF;">1.0</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd931b27" class="outline-2">
<h2 id="orgd931b27"><span class="section-number-2">21</span> Exercise 1.32</h2>
<div class="outline-text-2" id="text-21">
<p>
same as 1.31 but replace 1.0 with null-value
</p>
</div>
</div>

<div id="outline-container-orgf8670de" class="outline-2">
<h2 id="orgf8670de"><span class="section-number-2">22</span> Exercise 1.34</h2>
<div class="outline-text-2" id="text-22">
<p>
(2 2) Error: the object 2 is not applicable.
</p>
</div>
</div>

<div id="outline-container-org08b57dd" class="outline-2">
<h2 id="org08b57dd"><span class="section-number-2">23</span> Exercise 1.35</h2>
<div class="outline-text-2" id="text-23">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">abs</span> a<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>&lt; a <span style="color: #BFEBBF;">0</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>* <span style="color: #BFEBBF;">-1</span> a<span style="color: #D0BF8F;">)</span>
      a<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">fixed-point</span> f first-guess<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">tolerance</span> <span style="color: #BFEBBF;">0.00001</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">close-enough?</span> a b<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>&lt; <span style="color: #93E0E3;">(</span>abs <span style="color: #9FC59F;">(</span>- a b<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span> tolerance<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">try</span> guess<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>y <span style="color: #94BFF3;">(</span>f guess<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>close-enough? guess y<span style="color: #9FC59F;">)</span>
          y
          <span style="color: #9FC59F;">(</span>try y<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>try first-guess<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>fixed-point <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>+ <span style="color: #BFEBBF;">1</span> <span style="color: #93E0E3;">(</span>/ <span style="color: #BFEBBF;">1</span> x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">1.0</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgef64ca4" class="outline-2">
<h2 id="orgef64ca4"><span class="section-number-2">24</span> Exercise 1.36</h2>
<div class="outline-text-2" id="text-24">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span>fixed-point <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span>
               <span style="color: #D0BF8F;">(</span>/ <span style="color: #93E0E3;">(</span>+ x
                     <span style="color: #9FC59F;">(</span>/ <span style="color: #94BFF3;">(</span>log <span style="color: #BFEBBF;">1000</span><span style="color: #94BFF3;">)</span>
                        <span style="color: #94BFF3;">(</span>log x<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
                  <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
             <span style="color: #BFEBBF;">2.0</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c22bec" class="outline-2">
<h2 id="org0c22bec"><span class="section-number-2">25</span> Exercise 1.37</h2>
<div class="outline-text-2" id="text-25">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cont-frac</span> n d k<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">try</span> m<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #93E0E3;">(</span>= m k<span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>/ <span style="color: #9FC59F;">(</span>n m<span style="color: #9FC59F;">)</span>
           <span style="color: #9FC59F;">(</span>d m<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>/ <span style="color: #9FC59F;">(</span>n m<span style="color: #9FC59F;">)</span>
           <span style="color: #9FC59F;">(</span>+ <span style="color: #94BFF3;">(</span>d m<span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>try <span style="color: #E0CF9F;">(</span>+ <span style="color: #BFEBBF;">1</span> m<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>try <span style="color: #BFEBBF;">1.0</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>


<span style="color: #DCDCCC;">(</span>cont-frac <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>i<span style="color: #D0BF8F;">)</span> <span style="color: #BFEBBF;">1.0</span><span style="color: #BFEBBF;">)</span>
           <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>i<span style="color: #D0BF8F;">)</span> <span style="color: #BFEBBF;">1.0</span><span style="color: #BFEBBF;">)</span>
           <span style="color: #BFEBBF;">2</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga6d3812" class="outline-2">
<h2 id="orga6d3812"><span class="section-number-2">26</span> Exercise 1.40</h2>
<div class="outline-text-2" id="text-26">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">cubic</span> a b c<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>+ <span style="color: #93E0E3;">(</span>cube x<span style="color: #93E0E3;">)</span>
                 <span style="color: #93E0E3;">(</span>* a <span style="color: #9FC59F;">(</span>square x<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
                 <span style="color: #93E0E3;">(</span>* b x<span style="color: #93E0E3;">)</span>
                 c<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf8a7cd9" class="outline-2">
<h2 id="orgf8a7cd9"><span class="section-number-2">27</span> Exercise 1.42</h2>
<div class="outline-text-2" id="text-27">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">compose</span> f g<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>f <span style="color: #93E0E3;">(</span>g x<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org53a70ee" class="outline-2">
<h2 id="org53a70ee"><span class="section-number-2">28</span> Exercise 1.43</h2>
<div class="outline-text-2" id="text-28">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">repeated</span> f n<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>= n <span style="color: #BFEBBF;">1</span><span style="color: #D0BF8F;">)</span>
      f
      <span style="color: #D0BF8F;">(</span>compose f <span style="color: #93E0E3;">(</span>repeated f <span style="color: #9FC59F;">(</span>- n <span style="color: #BFEBBF;">1</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #BFEBBF;">(</span>repeated square <span style="color: #BFEBBF;">2</span><span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">5</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">smooth</span> f<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>/ <span style="color: #93E0E3;">(</span>+ <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>- x dx<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>f x<span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>f <span style="color: #94BFF3;">(</span>+ x dx<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
       <span style="color: #BFEBBF;">3</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #BFEBBF;">(</span>repeated smooth <span style="color: #BFEBBF;">10</span><span style="color: #BFEBBF;">)</span> f<span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc6566d7" class="outline-2">
<h2 id="orgc6566d7"><span class="section-number-2">29</span> Exercise 2.1</h2>
<div class="outline-text-2" id="text-29">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-rat</span> n d<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">cond</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>&lt; d <span style="color: #BFEBBF;">0</span><span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons <span style="color: #9FC59F;">(</span>* <span style="color: #BFEBBF;">-1</span> n<span style="color: #9FC59F;">)</span> <span style="color: #9FC59F;">(</span>* <span style="color: #BFEBBF;">-1</span> d<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
        <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #93E0E3;">(</span>cons n d<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb457321" class="outline-2">
<h2 id="orgb457321"><span class="section-number-2">30</span> Exercise 2.2</h2>
<div class="outline-text-2" id="text-30">
<div class="org-src-container">
<pre class="src src-scheme">   <span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-segment</span> start-seg end-seg<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cons start-seg end-seg<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">start-segment</span> line-seg<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>car line-seg<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">end-segment</span> line-seg<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cdr line-seg<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">make-point</span> x-poi y-poi<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cons x-poi y-poi<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">x-point</span> point<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>car point<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">y-point</span> point<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>cdr point<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">midpoint-segment</span> line-seg<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">(</span>start-seg <span style="color: #9FC59F;">(</span>start-segment line-seg<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span>end-seg <span style="color: #9FC59F;">(</span>end-segment line-seg<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>start-x-poi <span style="color: #94BFF3;">(</span>x-point start-seg<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>start-y-poi <span style="color: #94BFF3;">(</span>y-point start-seg<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>end-x-poi <span style="color: #94BFF3;">(</span>x-point end-seg<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #9FC59F;">(</span>end-y-poi <span style="color: #94BFF3;">(</span>y-point end-seg<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span>make-point <span style="color: #9FC59F;">(</span>/ <span style="color: #94BFF3;">(</span>+ start-x-poi end-x-poi<span style="color: #94BFF3;">)</span> <span style="color: #BFEBBF;">2</span><span style="color: #9FC59F;">)</span>
                  <span style="color: #9FC59F;">(</span>/ <span style="color: #94BFF3;">(</span>+ start-x-poi start-y-poi<span style="color: #94BFF3;">)</span> <span style="color: #BFEBBF;">2</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">print-point</span> p<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>newline<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">"("</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #D0BF8F;">(</span>x-point p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">","</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #D0BF8F;">(</span>y-point p<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>display <span style="color: #CC9393;">")"</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org5f9dde4" class="outline-2">
<h2 id="org5f9dde4"><span class="section-number-2">31</span> Exercise 2.20</h2>
<div class="outline-text-2" id="text-31">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">even?</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>= <span style="color: #BFEBBF;">0</span> <span style="color: #D0BF8F;">(</span>remainder x <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">odd?</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>not <span style="color: #D0BF8F;">(</span>even? x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">same-parity</span> x . items<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #D0BF8F;">(</span><span style="color: #93E0E3;">select</span> f l<span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">(</span><span style="color: #93E0E3;">iter</span> ll result<span style="color: #93E0E3;">)</span>
      <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>null? ll<span style="color: #9FC59F;">)</span>
          result
          <span style="color: #9FC59F;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #94BFF3;">(</span>f <span style="color: #E0CF9F;">(</span>car ll<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>iter <span style="color: #E0CF9F;">(</span>cdr ll<span style="color: #E0CF9F;">)</span> <span style="color: #E0CF9F;">(</span>cons result <span style="color: #8FB28F;">(</span>car ll<span style="color: #8FB28F;">)</span><span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span>
              <span style="color: #94BFF3;">(</span>iter <span style="color: #E0CF9F;">(</span>cdr ll<span style="color: #E0CF9F;">)</span> result<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
          <span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
    <span style="color: #D0BF8F;">(</span>iter l '<span style="color: #93E0E3;">()</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>odd? x<span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>cons x <span style="color: #93E0E3;">(</span>select odd? items<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
      <span style="color: #D0BF8F;">(</span>cons x <span style="color: #93E0E3;">(</span>select even? items<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d07bb2" class="outline-2">
<h2 id="org7d07bb2"><span class="section-number-2">32</span> Exercise 2.23</h2>
<div class="outline-text-2" id="text-32">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">for-each</span> proc items<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? items<span style="color: #D0BF8F;">)</span>
      true
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">begin</span>
        <span style="color: #93E0E3;">(</span>proc <span style="color: #9FC59F;">(</span>car items<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">for-each</span> proc <span style="color: #9FC59F;">(</span>cdr items<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">for-each</span> <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #D0BF8F;">(</span>x<span style="color: #D0BF8F;">)</span>
            <span style="color: #D0BF8F;">(</span>newline<span style="color: #D0BF8F;">)</span>
            <span style="color: #D0BF8F;">(</span>display x<span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span>
          <span style="color: #BFEBBF;">(</span>list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org17abb9e" class="outline-2">
<h2 id="org17abb9e"><span class="section-number-2">33</span> Exercise 2.30</h2>
<div class="outline-text-2" id="text-33">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square-tree</span> tree<span style="color: #BFEBBF;">)</span>
  <span style="color: #CC9393;">"directly"</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">nil</span> '<span style="color: #D0BF8F;">()</span><span style="color: #BFEBBF;">)</span>

  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? tree<span style="color: #D0BF8F;">)</span>
      nil
      <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">let</span> <span style="color: #93E0E3;">(</span><span style="color: #9FC59F;">(</span>first <span style="color: #94BFF3;">(</span>car tree<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span>
        <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>not <span style="color: #94BFF3;">(</span>pair? first<span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span>cons <span style="color: #94BFF3;">(</span>square first<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>square-tree <span style="color: #E0CF9F;">(</span>cdr tree<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span>
            <span style="color: #9FC59F;">(</span>cons <span style="color: #94BFF3;">(</span>square-tree first<span style="color: #94BFF3;">)</span> <span style="color: #94BFF3;">(</span>square-tree <span style="color: #E0CF9F;">(</span>cdr tree<span style="color: #E0CF9F;">)</span><span style="color: #94BFF3;">)</span><span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>square-tree <span style="color: #BFEBBF;">(</span>list <span style="color: #D0BF8F;">(</span>list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>list <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square-tree</span> tree<span style="color: #BFEBBF;">)</span>
  <span style="color: #CC9393;">"use map"</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>sub-tree<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>pair? sub-tree<span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>square-tree sub-tree<span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>square sub-tree<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       tree<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>square-tree <span style="color: #BFEBBF;">(</span>list <span style="color: #D0BF8F;">(</span>list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span><span style="color: #D0BF8F;">)</span> <span style="color: #D0BF8F;">(</span>list <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb1a705" class="outline-2">
<h2 id="orgdb1a705"><span class="section-number-2">34</span> Exercise 2.31</h2>
<div class="outline-text-2" id="text-34">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">tree-map</span> f tree<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>sub-tree<span style="color: #93E0E3;">)</span>
         <span style="color: #93E0E3;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #9FC59F;">(</span>pair? sub-tree<span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>square-tree sub-tree<span style="color: #9FC59F;">)</span>
             <span style="color: #9FC59F;">(</span>f sub-tree<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
       tree<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org50a89ff" class="outline-2">
<h2 id="org50a89ff"><span class="section-number-2">35</span> Exercise 2.33</h2>
<div class="outline-text-2" id="text-35">
<div class="org-src-container">
<pre class="src src-scheme"><span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">accumulate</span> op initial sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span><span style="color: #F0DFAF; font-weight: bold;">if</span> <span style="color: #D0BF8F;">(</span>null? sequence<span style="color: #D0BF8F;">)</span>
      initial
      <span style="color: #D0BF8F;">(</span>op <span style="color: #93E0E3;">(</span>car sequence<span style="color: #93E0E3;">)</span>
          <span style="color: #93E0E3;">(</span>accumulate op initial <span style="color: #9FC59F;">(</span>cdr sequence<span style="color: #9FC59F;">)</span><span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">nil</span> '<span style="color: #BFEBBF;">()</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">map</span> p sequence<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate <span style="color: #D0BF8F;">(</span><span style="color: #F0DFAF; font-weight: bold;">lambda</span> <span style="color: #93E0E3;">(</span>x y<span style="color: #93E0E3;">)</span> <span style="color: #93E0E3;">(</span>cons <span style="color: #9FC59F;">(</span>p x<span style="color: #9FC59F;">)</span> y<span style="color: #93E0E3;">)</span><span style="color: #D0BF8F;">)</span>
              nil
              sequence<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">square</span> x<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>* x x<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #BFEBBF;">(</span><span style="color: #93E0E3;">append</span> seq1 seq2<span style="color: #BFEBBF;">)</span>
  <span style="color: #BFEBBF;">(</span>accumulate cons seq2 seq1<span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span><span style="color: #F0DFAF; font-weight: bold;">map</span> square <span style="color: #BFEBBF;">(</span>list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>

<span style="color: #DCDCCC;">(</span>append <span style="color: #BFEBBF;">(</span>list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span><span style="color: #BFEBBF;">)</span> <span style="color: #BFEBBF;">(</span>list <span style="color: #BFEBBF;">4</span> <span style="color: #BFEBBF;">5</span> <span style="color: #BFEBBF;">6</span><span style="color: #BFEBBF;">)</span><span style="color: #DCDCCC;">)</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<div>
<p class="author">Author: <a href="https://gitlab.com/jgkamat/jgkamat.gitlab.io"> Norris</a></p>
<p class="date">Published: </p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 26.1 (<a href="https://orgmode.org">Org</a> mode 9.3.1)</p>
</div>
</div>
</body>
</html>
