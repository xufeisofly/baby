<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SICP exercises</title>
<meta name="generator" content="Org mode" />
<meta name="author" content=" Norris" />
<link rel="stylesheet" type="text/css" href="https://gongzhitaao.org/orgcss/org.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2019 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">SICP exercises</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org93613c7">1. Exercise 1.1</a></li>
<li><a href="#orgd213ca0">2. Exercise 1.2</a></li>
<li><a href="#org53c8ec8">3. Exercise 1.3</a></li>
<li><a href="#org9b2ca4e">4. Exercise 1.4</a></li>
<li><a href="#org5588fad">5. Exercise 1.5</a></li>
<li><a href="#org40fd791">6. Exercise 1.6</a></li>
<li><a href="#orgdf93a28">7. Exercise 1.7</a></li>
<li><a href="#orgaad7a3f">8. Exercise 1.8</a></li>
<li><a href="#orgfd11e27">9. Exercise 1.9</a></li>
<li><a href="#orgdf38a35">10. Exercise 1.10</a></li>
<li><a href="#orgd9c5bd1">11. Exercise 1.11</a></li>
<li><a href="#orgf52b294">12. Exercise 1.12</a></li>
<li><a href="#org085f9b6">13. Exercise 1.16</a></li>
<li><a href="#org81763c8">14. Exercise 1.17</a></li>
<li><a href="#orgf271538">15. Exercise 1.21</a></li>
<li><a href="#org5d9f8b7">16. Exercise 1.22</a></li>
<li><a href="#org0f6bd0c">17. Exercise 1.26</a></li>
<li><a href="#org94262b2">18. Exercise 1.29</a></li>
<li><a href="#orgebfd88c">19. Exercise 1.30</a></li>
<li><a href="#org80758c4">20. Exercise 1.31</a>
<ul>
<li><a href="#org2fc7af8">20.1. a</a></li>
<li><a href="#org52643cd">20.2. b</a></li>
</ul>
</li>
<li><a href="#orgd931b27">21. Exercise 1.32</a></li>
<li><a href="#orgf8670de">22. Exercise 1.34</a></li>
<li><a href="#org08b57dd">23. Exercise 1.35</a></li>
<li><a href="#orgef64ca4">24. Exercise 1.36</a></li>
<li><a href="#org0c22bec">25. Exercise 1.37</a></li>
<li><a href="#orga6d3812">26. Exercise 1.40</a></li>
<li><a href="#orgf8a7cd9">27. Exercise 1.42</a></li>
<li><a href="#org53a70ee">28. Exercise 1.43</a></li>
<li><a href="#orgc6566d7">29. Exercise 2.1</a></li>
<li><a href="#orgb457321">30. Exercise 2.2</a></li>
<li><a href="#org5f9dde4">31. Exercise 2.20</a></li>
<li><a href="#org7d07bb2">32. Exercise 2.23</a></li>
<li><a href="#org17abb9e">33. Exercise 2.30</a></li>
<li><a href="#orgdb1a705">34. Exercise 2.31</a></li>
<li><a href="#org50a89ff">35. Exercise 2.33</a></li>
</ul>
</div>
</div>

<div id="outline-container-org93613c7" class="outline-2">
<h2 id="org93613c7"><span class="section-number-2">1</span> Exercise 1.1</h2>
<div class="outline-text-2" id="text-1">
<p>
10
12
8
3
4
a
b
19
#f
4
16
6
6
16
</p>
</div>
</div>

<div id="outline-container-orgd213ca0" class="outline-2">
<h2 id="orgd213ca0"><span class="section-number-2">2</span> Exercise 1.2</h2>
<div class="outline-text-2" id="text-2">
<div class="org-src-container">
<pre class="src src-scheme">(/ (+ 
    <span style="color: #BFEBBF;">5</span> <span style="color: #BFEBBF;">4</span> 
    (- <span style="color: #BFEBBF;">2</span> 
       (- <span style="color: #BFEBBF;">3</span> 
          (+ <span style="color: #BFEBBF;">6</span> 
             (/ <span style="color: #BFEBBF;">4</span> <span style="color: #BFEBBF;">5</span>))))) 
   (* <span style="color: #BFEBBF;">3</span> 
      (- <span style="color: #BFEBBF;">6</span> <span style="color: #BFEBBF;">2</span>) 
      (- <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">7</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org53c8ec8" class="outline-2">
<h2 id="org53c8ec8"><span class="section-number-2">3</span> Exercise 1.3</h2>
<div class="outline-text-2" id="text-3">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">sum_of_square</span> x y) 
  (+ (* x x) (* y y)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">procedure</span> a b c) 
  (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((<span style="color: #F0DFAF; font-weight: bold;">or</span> (&lt; c a) (&lt; c b)) (sum_of_square a b))
        ((<span style="color: #F0DFAF; font-weight: bold;">or</span> (&lt; b a) (&lt; b c)) (sum_of_square a c))
        ((<span style="color: #F0DFAF; font-weight: bold;">or</span> (&lt; a b) (&lt; a c)) (sum_of_square b c))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org9b2ca4e" class="outline-2">
<h2 id="org9b2ca4e"><span class="section-number-2">4</span> Exercise 1.4</h2>
<div class="outline-text-2" id="text-4">
<p>
if b &gt; 0，return a + b, else return a - b, overall return a + abs(b)
</p>
</div>
</div>

<div id="outline-container-org5588fad" class="outline-2">
<h2 id="org5588fad"><span class="section-number-2">5</span> Exercise 1.5</h2>
<div class="outline-text-2" id="text-5">
<p>
normal order:
</p>

<div class="org-src-container">
<pre class="src src-scheme">(test x y)
(<span style="color: #F0DFAF; font-weight: bold;">if</span> (= x <span style="color: #BFEBBF;">0</span>) <span style="color: #BFEBBF;">0</span> y)
(<span style="color: #F0DFAF; font-weight: bold;">if</span> (= <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">0</span>) <span style="color: #BFEBBF;">0</span> (p))
<span style="color: #BFEBBF;">0</span>
</pre>
</div>

<p>
applicative order:
</p>

<div class="org-src-container">
<pre class="src src-scheme">(test <span style="color: #BFEBBF;">0</span> (p))
(test <span style="color: #BFEBBF;">0</span> (p))
...
</pre>
</div>
</div>
</div>

<div id="outline-container-org40fd791" class="outline-2">
<h2 id="org40fd791"><span class="section-number-2">6</span> Exercise 1.6</h2>
<div class="outline-text-2" id="text-6">
<p>
use if:
</p>

<p>
special form will not use applicative order to analize a procedure, thus clause in old if will not run unless predicate meets. 
</p>

<p>
use new-if:
</p>

<p>
use applicative order, sqrt-iter clause will be expanded, leading maximum recursion depth exceeded.
</p>
</div>
</div>

<div id="outline-container-orgdf93a28" class="outline-2">
<h2 id="orgdf93a28"><span class="section-number-2">7</span> Exercise 1.7</h2>
<div class="outline-text-2" id="text-7">
<p>
because (good-enough?) is checked by absolute difference, small number might meet that in the very beginning.
</p>

<p>
for large numbers, is might cause (improve guess x) equals (guess), thus trapping in infinite loop.
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">abs</span> x)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&lt; x <span style="color: #BFEBBF;">0</span>)
      (* <span style="color: #BFEBBF;">-1</span> x)
      x))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">square</span> x)
  (* x x))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">sqrt-iter</span> guess old-guess x)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (good-enough? guess old-guess x)
      guess
      (sqrt-iter (improve guess x) guess x)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">improve</span> guess x)
  (average guess (/ x guess)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">average</span> x y)
  (/ (+ x y) <span style="color: #BFEBBF;">2</span>))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">good-enough?</span> guess old-guess x)
  (&lt; (abs (- guess old-guess)) (* guess <span style="color: #BFEBBF;">0.001</span>)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">sqrt</span> x)
  (sqrt-iter <span style="color: #BFEBBF;">1.0</span> <span style="color: #BFEBBF;">2.0</span> x))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">new-if</span> predicate then-clause else-clause)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (predicate)
      then-clause
      else-clause))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgaad7a3f" class="outline-2">
<h2 id="orgaad7a3f"><span class="section-number-2">8</span> Exercise 1.8</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">cube-root</span> x)
  (cube-root-iter <span style="color: #BFEBBF;">1.0</span> <span style="color: #BFEBBF;">2.0</span> x))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">cube-root-iter</span> guess old-guess x)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (good-enough? guess old-guess x)
      guess
      (cube-root-iter (improve guess x) guess x)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">improve</span> guess x)
  (/ (+ (/ x
           (* guess guess))
        (* <span style="color: #BFEBBF;">2</span> guess))
     <span style="color: #BFEBBF;">3</span>))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">good-enough?</span> guess old-guess x)
  (&lt; (abs (- guess
             old-guess))
     (* guess <span style="color: #BFEBBF;">0.001</span>)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">abs</span> x)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&lt; x <span style="color: #BFEBBF;">0</span>)
      (* <span style="color: #BFEBBF;">-1</span> x)
      x))

(cube-root <span style="color: #BFEBBF;">27</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgfd11e27" class="outline-2">
<h2 id="orgfd11e27"><span class="section-number-2">9</span> Exercise 1.9</h2>
<div class="outline-text-2" id="text-9">
<p>
first is recursive, second is iterative.
</p>
</div>
</div>

<div id="outline-container-orgdf38a35" class="outline-2">
<h2 id="orgdf38a35"><span class="section-number-2">10</span> Exercise 1.10</h2>
<div class="outline-text-2" id="text-10">
<div class="org-src-container">
<pre class="src src-scheme">(A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">10</span>)
(A (- <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span>) (A <span style="color: #BFEBBF;">1</span> (- <span style="color: #BFEBBF;">10</span> <span style="color: #BFEBBF;">1</span>)))
(A <span style="color: #BFEBBF;">0</span> (A (- <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span>) (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">8</span>)))
(A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">8</span>)))
(A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">7</span>))))
(A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">6</span>)))))
...
<span style="color: #BFEBBF;">1024</span>

(A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">4</span>)
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span>))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">2</span>)))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">1</span>))))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span>)))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span>))))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">2</span>)))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">4</span>))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">3</span>)))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span>))))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">1</span>)))))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">2</span>))))
(A <span style="color: #BFEBBF;">1</span> (A <span style="color: #BFEBBF;">0</span> (A <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">4</span>)))
(A <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">16</span>)

<span style="color: #BFEBBF;">65536</span>

(A <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">3</span>)
(A <span style="color: #BFEBBF;">2</span> (A <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">2</span>))
...
(A <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">4</span>)
<span style="color: #BFEBBF;">65536</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd9c5bd1" class="outline-2">
<h2 id="orgd9c5bd1"><span class="section-number-2">11</span> Exercise 1.11</h2>
<div class="outline-text-2" id="text-11">
<p>
recursive process
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">f</span> n)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&lt; n <span style="color: #BFEBBF;">3</span>)
      n
      (+ (f (- n <span style="color: #BFEBBF;">1</span>))
         (* <span style="color: #BFEBBF;">2</span> (f (- n <span style="color: #BFEBBF;">2</span>)))
         (* <span style="color: #BFEBBF;">3</span> (f (- n <span style="color: #BFEBBF;">3</span>))))))
</pre>
</div>

<p>
iterative process
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">f</span> n)
  (f-iter <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">0</span> n))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">f-iter</span> a b c count)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&lt; count <span style="color: #BFEBBF;">3</span>)
      a
      (f-iter (+ a
                 (* <span style="color: #BFEBBF;">2</span> b)
                 (* <span style="color: #BFEBBF;">3</span> c))
              a
              b
              (- count <span style="color: #BFEBBF;">1</span>))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf52b294" class="outline-2">
<h2 id="orgf52b294"><span class="section-number-2">12</span> Exercise 1.12</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">f</span> r c)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (<span style="color: #F0DFAF; font-weight: bold;">and</span> (&gt; r <span style="color: #BFEBBF;">1</span>)
           (not (eq? r c))
           (not (eq? c <span style="color: #BFEBBF;">0</span>)))
      (+ (f (- r <span style="color: #BFEBBF;">1</span>) (- c <span style="color: #BFEBBF;">1</span>))
         (f (- r <span style="color: #BFEBBF;">1</span>) c))
      <span style="color: #BFEBBF;">1</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org085f9b6" class="outline-2">
<h2 id="org085f9b6"><span class="section-number-2">13</span> Exercise 1.16</h2>
<div class="outline-text-2" id="text-13">
<p>
iterative process, even is faster than odd.
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">even?</span> n)
  (= (remainder n <span style="color: #BFEBBF;">2</span>) <span style="color: #BFEBBF;">0</span>))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">square</span> x)
  (* x x))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">fast-expt</span> b n)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (even? n)
      (fast-expt-iter <span style="color: #BFEBBF;">1</span>
                      (/ n <span style="color: #BFEBBF;">2</span>)
                      (square b))
      (fast-expt-iter <span style="color: #BFEBBF;">1</span> n b)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">fast-expt-iter</span> product count b)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (= count <span style="color: #BFEBBF;">0</span>)
      product
      (fast-expt-iter (* b product) (- count <span style="color: #BFEBBF;">1</span>) b)))

(fast-expt <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-org81763c8" class="outline-2">
<h2 id="org81763c8"><span class="section-number-2">14</span> Exercise 1.17</h2>
<div class="outline-text-2" id="text-14">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">double</span> a)
  (+ a a))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">fast-*</span> a n)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (even? n)
      (fast-*-iter <span style="color: #BFEBBF;">0</span> (/ n <span style="color: #BFEBBF;">2</span>) (double a))
      (fast-*-iter <span style="color: #BFEBBF;">0</span> n a)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">fast-*-iter</span> product count a)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (= count <span style="color: #BFEBBF;">0</span>)
      product
      (fast-*-iter (+ product a) (- count <span style="color: #BFEBBF;">1</span>) a)))

(fast-* <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">3</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf271538" class="outline-2">
<h2 id="orgf271538"><span class="section-number-2">15</span> Exercise 1.21</h2>
<div class="outline-text-2" id="text-15">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">smallest-divisor</span> n)
  (find-divisor-iter n <span style="color: #BFEBBF;">2</span>))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">find-divisor-iter</span> n test-divisor)
  (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((&gt; (square test-divisor) n) n)
        ((divides? n test-divisor) test-divisor)
        (<span style="color: #F0DFAF; font-weight: bold;">else</span> (find-divisor-iter n (+ test-divisor <span style="color: #BFEBBF;">1</span>)))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">divides?</span> n divisor)
  (= (remainder n divisor) <span style="color: #BFEBBF;">0</span>))

(smallest-divisor <span style="color: #BFEBBF;">199</span>)
(smallest-divisor <span style="color: #BFEBBF;">1999</span>)
(smallest-divisor <span style="color: #BFEBBF;">19999</span>)
</pre>
</div>

<p>
199 1999 7
</p>
</div>
</div>

<div id="outline-container-org5d9f8b7" class="outline-2">
<h2 id="org5d9f8b7"><span class="section-number-2">16</span> Exercise 1.22</h2>
<div class="outline-text-2" id="text-16">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">expmod</span> base exp mod)
  (remainder (expt base exp)
             mod))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">expt</span> base exp)
  (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((= exp <span style="color: #BFEBBF;">0</span>) <span style="color: #BFEBBF;">1</span>)
        (<span style="color: #F0DFAF; font-weight: bold;">else</span> (* base
                 (expt base (- exp <span style="color: #BFEBBF;">1</span>))))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">try-it</span> a n)
  (= (expmod a n n) a))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">fermat-test</span> a n)
  (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((= a <span style="color: #BFEBBF;">1</span>) true)
        ((try-it a n) (fermat-test (- a <span style="color: #BFEBBF;">1</span>) n))
        (<span style="color: #F0DFAF; font-weight: bold;">else</span> false)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">prime?</span> n)
  (fermat-test (- n <span style="color: #BFEBBF;">1</span>) n))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">timed-prime-test</span> n)
  (newline)
  (display n)
  (start-prime-test n (runtime)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">start-prime-test</span> n start-time)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (prime? n)
      (report-prime (- (runtime) start-time))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">report-prime</span> elapsed-time)
  (display <span style="color: #CC9393;">" *** "</span>)
  (display elapsed-time))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">even?</span> n)
  (= (remainder n <span style="color: #BFEBBF;">2</span>) <span style="color: #BFEBBF;">0</span>))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">search-for-primes</span> min max)
  (timed-prime-test min)
  (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((&lt; min max) (search-for-primes (+ <span style="color: #BFEBBF;">1</span> min) max))
        (<span style="color: #F0DFAF; font-weight: bold;">else</span> true)))


(search-for-primes <span style="color: #BFEBBF;">1000</span> <span style="color: #BFEBBF;">1100</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-org0f6bd0c" class="outline-2">
<h2 id="org0f6bd0c"><span class="section-number-2">17</span> Exercise 1.26</h2>
<div class="outline-text-2" id="text-17">
<p>
Reasoner's soluton has to run expmod twice, from linear recursion to tree recursion.
</p>

<p>
Time grows exponentially with the depth of tree height, log(n), thus the execution turns to n.
</p>
</div>
</div>

<div id="outline-container-org94262b2" class="outline-2">
<h2 id="org94262b2"><span class="section-number-2">18</span> Exercise 1.29</h2>
<div class="outline-text-2" id="text-18">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">sum</span> term a next b)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&gt; a b)
      <span style="color: #BFEBBF;">0</span>
      (+ (term a)
         (sum term (next a) next b))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">incr</span> n)
  (+ n <span style="color: #BFEBBF;">1</span>))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">sum-cubes</span> a b)
  (sum cude a incr b))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">even?</span> n)
  (= <span style="color: #BFEBBF;">0</span> (remainder n <span style="color: #BFEBBF;">2</span>)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">cube</span> n)
  (* n n n))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">simpson-rule</span> f a b x n k)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">h</span>
    (/ (- b a) n))

  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">coin</span> k)
    (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((<span style="color: #F0DFAF; font-weight: bold;">or</span> (= n k) (= <span style="color: #BFEBBF;">0</span> k)) <span style="color: #BFEBBF;">1</span>)
          ((even? k) <span style="color: #BFEBBF;">2</span>)
          (<span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #BFEBBF;">4</span>)))

  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">next</span> m)
    (+ m h))

  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&gt; x b)
      <span style="color: #BFEBBF;">0</span>
      (+ (* (coin k)
            (/ h <span style="color: #BFEBBF;">3</span>)
            (f x))
         (simpson-rule f a b (next x) n (+ k <span style="color: #BFEBBF;">1</span>)))))


(simpson-rule cube <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">1000</span> <span style="color: #BFEBBF;">0</span>)
</pre>
</div>

<p>
官方方法，外面包了一层，这样可以设置一些全局函数
</p>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">cube</span> x) (* x x x))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">sum</span> term a next b)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&gt; a b)
      <span style="color: #BFEBBF;">0</span>
      (+ (term a)
         (sum term (next a) next b))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">even?</span> n)
  (= <span style="color: #BFEBBF;">0</span> (remainder n <span style="color: #BFEBBF;">2</span>)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">simpson-integral</span> f a b n)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">h</span> (/ (- b a) n))
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">inc</span> m) (+ m <span style="color: #BFEBBF;">1</span>))
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">yk</span> k) (f (+ a (* k h))))
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">simpson-term</span> k)
    (* (yk k)
       (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((<span style="color: #F0DFAF; font-weight: bold;">or</span> (= k n) (= <span style="color: #BFEBBF;">0</span> k)) <span style="color: #BFEBBF;">1</span>)
             ((even? k) <span style="color: #BFEBBF;">2</span>)
             (<span style="color: #F0DFAF; font-weight: bold;">else</span> <span style="color: #BFEBBF;">4</span>))))
  (* (/ h <span style="color: #BFEBBF;">3</span>)
     (sum simpson-term <span style="color: #BFEBBF;">0</span> inc n)))

(simpson-integral cube <span style="color: #BFEBBF;">0</span> <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">100</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgebfd88c" class="outline-2">
<h2 id="orgebfd88c"><span class="section-number-2">19</span> Exercise 1.30</h2>
<div class="outline-text-2" id="text-19">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">sum</span> term a next b)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">iter</span> a result)
    (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&gt; a b)
        result
        (iter (next a) (+ result (term a)))))
  (iter a <span style="color: #BFEBBF;">0</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org80758c4" class="outline-2">
<h2 id="org80758c4"><span class="section-number-2">20</span> Exercise 1.31</h2>
<div class="outline-text-2" id="text-20">
</div>
<div id="outline-container-org2fc7af8" class="outline-3">
<h3 id="org2fc7af8"><span class="section-number-3">20.1</span> a</h3>
<div class="outline-text-3" id="text-20-1">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">product</span> term a next b conn)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&gt; a b)
      <span style="color: #BFEBBF;">1.0</span>
      (conn (term a)
            (product term (next a) next b conn))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">multiply</span> a b)
  (* a b))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">test-formula</span> a b)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">incr</span> n)
    (+ n <span style="color: #BFEBBF;">1</span>))
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">term</span> k)
    (<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">num</span>
      (* (floor (/ (+ k <span style="color: #BFEBBF;">2</span>) <span style="color: #BFEBBF;">2</span>))
         <span style="color: #BFEBBF;">2</span>))
    (<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">den</span>
      (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((even? k) (- num <span style="color: #BFEBBF;">1</span>))
            (<span style="color: #F0DFAF; font-weight: bold;">else</span> (+ num <span style="color: #BFEBBF;">1</span>))))
    (/ num den))

  (product term a incr b multiply))

(* <span style="color: #BFEBBF;">4</span> (test-formula <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">100</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org52643cd" class="outline-3">
<h3 id="org52643cd"><span class="section-number-3">20.2</span> b</h3>
<div class="outline-text-3" id="text-20-2">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">product</span> term a next b conn)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">iter</span> a result)
    (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&gt; a b)
        result
        (iter (next a) (conn result (term a)))))
  (iter a <span style="color: #BFEBBF;">1.0</span>))
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd931b27" class="outline-2">
<h2 id="orgd931b27"><span class="section-number-2">21</span> Exercise 1.32</h2>
<div class="outline-text-2" id="text-21">
<p>
same as 1.31 but replace 1.0 with null-value
</p>
</div>
</div>

<div id="outline-container-orgf8670de" class="outline-2">
<h2 id="orgf8670de"><span class="section-number-2">22</span> Exercise 1.34</h2>
<div class="outline-text-2" id="text-22">
<p>
(2 2) Error: the object 2 is not applicable.
</p>
</div>
</div>

<div id="outline-container-org08b57dd" class="outline-2">
<h2 id="org08b57dd"><span class="section-number-2">23</span> Exercise 1.35</h2>
<div class="outline-text-2" id="text-23">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">abs</span> a)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (&lt; a <span style="color: #BFEBBF;">0</span>)
      (* <span style="color: #BFEBBF;">-1</span> a)
      a))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">fixed-point</span> f first-guess)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">tolerance</span> <span style="color: #BFEBBF;">0.00001</span>)

  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">close-enough?</span> a b)
    (&lt; (abs (- a b)) tolerance))

  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">try</span> guess)
    (<span style="color: #F0DFAF; font-weight: bold;">let</span> ((y (f guess)))
      (<span style="color: #F0DFAF; font-weight: bold;">if</span> (close-enough? guess y)
          y
          (try y))))
  (try first-guess))

(fixed-point (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (x) (+ <span style="color: #BFEBBF;">1</span> (/ <span style="color: #BFEBBF;">1</span> x))) <span style="color: #BFEBBF;">1.0</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgef64ca4" class="outline-2">
<h2 id="orgef64ca4"><span class="section-number-2">24</span> Exercise 1.36</h2>
<div class="outline-text-2" id="text-24">
<div class="org-src-container">
<pre class="src src-scheme">(fixed-point (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (x)
               (/ (+ x
                     (/ (log <span style="color: #BFEBBF;">1000</span>)
                        (log x)))
                  <span style="color: #BFEBBF;">2</span>))
             <span style="color: #BFEBBF;">2.0</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org0c22bec" class="outline-2">
<h2 id="org0c22bec"><span class="section-number-2">25</span> Exercise 1.37</h2>
<div class="outline-text-2" id="text-25">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">cont-frac</span> n d k)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">try</span> m)
    (<span style="color: #F0DFAF; font-weight: bold;">if</span> (= m k)
        (/ (n m)
           (d m))
        (/ (n m)
           (+ (d m)
              (try (+ <span style="color: #BFEBBF;">1</span> m))))))
  (try <span style="color: #BFEBBF;">1.0</span>))


(cont-frac (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (i) <span style="color: #BFEBBF;">1.0</span>)
           (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (i) <span style="color: #BFEBBF;">1.0</span>)
           <span style="color: #BFEBBF;">2</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orga6d3812" class="outline-2">
<h2 id="orga6d3812"><span class="section-number-2">26</span> Exercise 1.40</h2>
<div class="outline-text-2" id="text-26">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">cubic</span> a b c)
  (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (x) (+ (cube x)
                 (* a (square x))
                 (* b x)
                 c)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf8a7cd9" class="outline-2">
<h2 id="orgf8a7cd9"><span class="section-number-2">27</span> Exercise 1.42</h2>
<div class="outline-text-2" id="text-27">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">compose</span> f g)
  (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (x) (f (g x))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org53a70ee" class="outline-2">
<h2 id="org53a70ee"><span class="section-number-2">28</span> Exercise 1.43</h2>
<div class="outline-text-2" id="text-28">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">repeated</span> f n)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (= n <span style="color: #BFEBBF;">1</span>)
      f
      (compose f (repeated f (- n <span style="color: #BFEBBF;">1</span>)))))

((repeated square <span style="color: #BFEBBF;">2</span>) <span style="color: #BFEBBF;">5</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">smooth</span> f)
  (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (x)
    (/ (+ (f (- x dx))
          (f x)
          (f (+ x dx)))
       <span style="color: #BFEBBF;">3</span>)))

((repeated smooth <span style="color: #BFEBBF;">10</span>) f)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc6566d7" class="outline-2">
<h2 id="orgc6566d7"><span class="section-number-2">29</span> Exercise 2.1</h2>
<div class="outline-text-2" id="text-29">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">make-rat</span> n d)
  (<span style="color: #F0DFAF; font-weight: bold;">cond</span> ((&lt; d <span style="color: #BFEBBF;">0</span>) (cons (* <span style="color: #BFEBBF;">-1</span> n) (* <span style="color: #BFEBBF;">-1</span> d)))
        (<span style="color: #F0DFAF; font-weight: bold;">else</span> (cons n d))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb457321" class="outline-2">
<h2 id="orgb457321"><span class="section-number-2">30</span> Exercise 2.2</h2>
<div class="outline-text-2" id="text-30">
<div class="org-src-container">
<pre class="src src-scheme">   (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">make-segment</span> start-seg end-seg)
  (cons start-seg end-seg))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">start-segment</span> line-seg)
  (car line-seg))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">end-segment</span> line-seg)
  (cdr line-seg))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">make-point</span> x-poi y-poi)
  (cons x-poi y-poi))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">x-point</span> point)
  (car point))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">y-point</span> point)
  (cdr point))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">midpoint-segment</span> line-seg)
  (<span style="color: #F0DFAF; font-weight: bold;">let</span> ((start-seg (start-segment line-seg))
        (end-seg (end-segment line-seg)))
    (<span style="color: #F0DFAF; font-weight: bold;">let</span> ((start-x-poi (x-point start-seg))
          (start-y-poi (y-point start-seg))
          (end-x-poi (x-point end-seg))
          (end-y-poi (y-point end-seg)))
      (make-point (/ (+ start-x-poi end-x-poi) <span style="color: #BFEBBF;">2</span>)
                  (/ (+ start-x-poi start-y-poi) <span style="color: #BFEBBF;">2</span>)))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">print-point</span> p)
  (newline)
  (display <span style="color: #CC9393;">"("</span>)
  (display (x-point p))
  (display <span style="color: #CC9393;">","</span>)
  (display (y-point p))
  (display <span style="color: #CC9393;">")"</span>))

</pre>
</div>
</div>
</div>

<div id="outline-container-org5f9dde4" class="outline-2">
<h2 id="org5f9dde4"><span class="section-number-2">31</span> Exercise 2.20</h2>
<div class="outline-text-2" id="text-31">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">even?</span> x)
  (= <span style="color: #BFEBBF;">0</span> (remainder x <span style="color: #BFEBBF;">2</span>)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">odd?</span> x)
  (not (even? x)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">same-parity</span> x . items)
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">select</span> f l)
    (<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">iter</span> ll result)
      (<span style="color: #F0DFAF; font-weight: bold;">if</span> (null? ll)
          result
          (<span style="color: #F0DFAF; font-weight: bold;">if</span> (f (car ll))
              (iter (cdr ll) (cons result (car ll)))
              (iter (cdr ll) result))
          ))
    (iter l '()))

  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (odd? x)
      (cons x (select odd? items))
      (cons x (select even? items))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d07bb2" class="outline-2">
<h2 id="org7d07bb2"><span class="section-number-2">32</span> Exercise 2.23</h2>
<div class="outline-text-2" id="text-32">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">for-each</span> proc items)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (null? items)
      true
      (<span style="color: #F0DFAF; font-weight: bold;">begin</span>
        (proc (car items))
        (<span style="color: #F0DFAF; font-weight: bold;">for-each</span> proc (cdr items)))))

(<span style="color: #F0DFAF; font-weight: bold;">for-each</span> (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (x)
            (newline)
            (display x))
          (list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span>))
</pre>
</div>
</div>
</div>

<div id="outline-container-org17abb9e" class="outline-2">
<h2 id="org17abb9e"><span class="section-number-2">33</span> Exercise 2.30</h2>
<div class="outline-text-2" id="text-33">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">square-tree</span> tree)
  <span style="color: #CC9393;">"directly"</span>
  (<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">nil</span> '())

  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (null? tree)
      nil
      (<span style="color: #F0DFAF; font-weight: bold;">let</span> ((first (car tree)))
        (<span style="color: #F0DFAF; font-weight: bold;">if</span> (not (pair? first))
            (cons (square first) (square-tree (cdr tree)))
            (cons (square-tree first) (square-tree (cdr tree)))))))

(square-tree (list (list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span>) (list <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span>)))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">square-tree</span> tree)
  <span style="color: #CC9393;">"use map"</span>
  (<span style="color: #F0DFAF; font-weight: bold;">map</span> (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (sub-tree)
         (<span style="color: #F0DFAF; font-weight: bold;">if</span> (pair? sub-tree)
             (square-tree sub-tree)
             (square sub-tree)))
       tree))

(square-tree (list (list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span>) (list <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb1a705" class="outline-2">
<h2 id="orgdb1a705"><span class="section-number-2">34</span> Exercise 2.31</h2>
<div class="outline-text-2" id="text-34">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">tree-map</span> f tree)
  (<span style="color: #F0DFAF; font-weight: bold;">map</span> (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (sub-tree)
         (<span style="color: #F0DFAF; font-weight: bold;">if</span> (pair? sub-tree)
             (square-tree sub-tree)
             (f sub-tree)))
       tree))
</pre>
</div>
</div>
</div>

<div id="outline-container-org50a89ff" class="outline-2">
<h2 id="org50a89ff"><span class="section-number-2">35</span> Exercise 2.33</h2>
<div class="outline-text-2" id="text-35">
<div class="org-src-container">
<pre class="src src-scheme">(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">accumulate</span> op initial sequence)
  (<span style="color: #F0DFAF; font-weight: bold;">if</span> (null? sequence)
      initial
      (op (car sequence)
          (accumulate op initial (cdr sequence)))))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> <span style="color: #93E0E3;">nil</span> '())

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">map</span> p sequence)
  (accumulate (<span style="color: #F0DFAF; font-weight: bold;">lambda</span> (x y) (cons (p x) y))
              nil
              sequence))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">square</span> x)
  (* x x))

(<span style="color: #F0DFAF; font-weight: bold;">define</span> (<span style="color: #93E0E3;">append</span> seq1 seq2)
  (accumulate cons seq2 seq1))

(<span style="color: #F0DFAF; font-weight: bold;">map</span> square (list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span> <span style="color: #BFEBBF;">4</span>))

(append (list <span style="color: #BFEBBF;">1</span> <span style="color: #BFEBBF;">2</span> <span style="color: #BFEBBF;">3</span>) (list <span style="color: #BFEBBF;">4</span> <span style="color: #BFEBBF;">5</span> <span style="color: #BFEBBF;">6</span>))
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">

<div>
<p class="author">Author: <a href="https://gitlab.com/jgkamat/jgkamat.gitlab.io"> Norris</a></p>
<p class="date">Published: </p>
<p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 26.1 (<a href="https://orgmode.org">Org</a> mode 9.3.1)</p>
</div>
</div>
</body>
</html>
